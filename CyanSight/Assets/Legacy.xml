<?xml version="1.0" encoding="utf-8"?>
<CyanSight>
	<Configuration category="System">

		<Item name="æé«˜å‰å°ç¨‹åºçš„æ˜¾ç¤ºé€Ÿåº¦">
			<Tags>Focus,ForegroundLockTimeout,ç„¦ç‚¹,å¼¹çª—,å‰å°é”å®š</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_CURRENT_USER\Control Panel\Desktop"
					Value="ForegroundLockTimeout"
					Data="0" />
			</StatusChecks>

			<Description>
				<![CDATA[
# ğŸš€ æé«˜å‰å°ç¨‹åºçš„æ˜¾ç¤ºé€Ÿåº¦

### ğŸ“ åŸå§‹æè¿°
å…è®¸ç¨‹åºæ›´â€œéœ¸é“â€åœ°æŠ¢å ç„¦ç‚¹ï¼Œç¦ç”¨ Windows çš„é˜²ç„¦ç‚¹çªƒå–ä¿æŠ¤ã€‚

### ğŸ“… çŠ¶æ€è¯´æ˜
* **åˆ†ç±»**ï¼šè¿‡æ—¶/å‰¯ä½œç”¨ä¼˜åŒ–
* **æŠ€æœ¯åŸç†**ï¼š
Windows æœ‰ä¸€ç§æœºåˆ¶å«â€œç„¦ç‚¹çªƒå–ä¿æŠ¤â€ã€‚å½“ä½ åœ¨æ‰“å­—æ—¶ï¼Œå¦‚æœåå°æœ‰ä¸ªç¨‹åºçªç„¶æƒ³å¼¹çª—ï¼ŒWindows ä¼šè®©å®ƒåœ¨ä»»åŠ¡æ é—ªçƒï¼Œè€Œä¸æ˜¯ç›´æ¥å¼¹å‡ºæ¥æ‰“æ–­ä½ ã€‚
è¿™ä¸ªæ³¨å†Œè¡¨å€¼å®šä¹‰äº†â€œè¶…æ—¶æ—¶é—´â€ã€‚è®¾ä¸º `0` æ„å‘³ç€**ç¦ç”¨ä¿æŠ¤**ï¼Œä»»ä½•ç¨‹åºè¯·æ±‚ç½®é¡¶æ—¶ï¼ŒWindows ä¼šç«‹å³æ‰¹å‡†ï¼Œä¸å†ç­‰å¾…ã€‚

* **å‰¯ä½œç”¨**ï¼šè®¾ç½®ä¸º 0 åï¼Œå¦‚æœä½ æ­£åœ¨æ‰“å­—æˆ–ç©æ¸¸æˆï¼Œåå°ç¨‹åºå¼¹çª—ä¼šç›´æ¥åˆ‡æ–­ä½ çš„æ“ä½œå¹¶ç½®é¡¶ï¼Œè€Œä¸æ˜¯åœ¨ä»»åŠ¡æ é—ªçƒç­‰å¾…ã€‚

---
    {AutoDetails}
            ]]>
			</Description>

			<Optimize>
				<RegWrite
					Key="HKEY_CURRENT_USER\Control Panel\Desktop"
					Value="ForegroundLockTimeout"
					Type="REG_DWORD"
					Data="0"/>
			</Optimize>

			<Restore>
				<RegWrite
					Key="HKEY_CURRENT_USER\Control Panel\Desktop"
					Value="ForegroundLockTimeout"
					Type="REG_DWORD"
					Data="200000"/>
			</Restore>
		</Item>

		<Item name="ä¼˜åŒ–å¤„ç†å™¨æ€§èƒ½">
			
			<Tags>CPU,Win32PrioritySeparation,IRQ8Priority,IRQ16Priority,ä¸­æ–­è¯·æ±‚,æ—¶é—´ç‰‡</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl"
					Value="Win32PrioritySeparation"
					Data="38" />
				<Check
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl"
					Value="IRQ8Priority"
					Data="1" />
			</StatusChecks>

			<Description>
				<![CDATA[
# ğŸ§  ä¼˜åŒ–å¤„ç†å™¨æ€§èƒ½ (Win32PrioritySeparation)

### ğŸ“ åŸå§‹æè¿°
é€šè¿‡è°ƒæ•´ CPU æ—¶é—´ç‰‡åˆ†é…ï¼ˆWin32PrioritySeparation=38ï¼‰å’Œæ‰‹åŠ¨æŒ‡å®š IRQ ä¸­æ–­ä¼˜å…ˆçº§æ¥æå‡æ€§èƒ½ã€‚

### ğŸ“… çŠ¶æ€è¯´æ˜
* **åˆ†ç±»**ï¼šè¿‡æ—¶/ç„å­¦ä¼˜åŒ–
* **é”®å€¼ 1**ï¼š`Win32PrioritySeparation` = `38` (åè¿›åˆ¶) -> `0x26` (åå…­è¿›åˆ¶)ã€‚
* **æŠ€æœ¯åŸç†**ï¼šè¿™æ˜¯ä¸€ä¸ªä½æ©ç ï¼ˆBitmaskï¼‰ï¼Œæ§åˆ¶ CPU å¦‚ä½•ç»™å‰å°å’Œåå°è¿›ç¨‹åˆ†é…â€œæ—¶é—´ç‰‡ï¼ˆQuantumï¼‰â€ã€‚
* é»˜è®¤å€¼é€šå¸¸æ˜¯ `2` (å¹³è¡¡)ã€‚
* è®¾ç½®ä¸º `38` (0x26) æ˜¯å¼ºåˆ¶è®©å‰å°ç¨‹åºè·å¾—**æ›´çŸ­ã€æ›´å¤šå˜**çš„æ—¶é—´ç‰‡ï¼Œç†è®ºä¸Šèƒ½å‡å°‘è¾“å…¥å»¶è¿Ÿã€‚


* **é”®å€¼ 2 & 3**ï¼š`IRQ8Priority`, `IRQ16Priority`ã€‚
* **åˆ†æ**ï¼šè¿™æ˜¯**â€œç„å­¦â€ä¼˜åŒ–**ï¼ˆPlaceboï¼‰ã€‚
* IRQï¼ˆä¸­æ–­è¯·æ±‚ï¼‰ä¼˜å…ˆçº§æ‰‹åŠ¨è®¾ç½®åœ¨ Windows XP æ—¶ä»£å¯èƒ½æœ‰ç”¨ï¼Œä½†åœ¨ç°ä»£ Windows (10/11) å’Œ APIC ç¡¬ä»¶æ¶æ„ä¸‹ï¼Œæ‰‹åŠ¨æŒ‡å®š IRQ8ï¼ˆå®æ—¶æ—¶é’Ÿï¼‰çš„ä¼˜å…ˆçº§é€šå¸¸**è¢«ç³»ç»Ÿå¿½ç•¥**ã€‚è¿™å±äºè¿‡æ—¶çš„ä¼˜åŒ–æ‰‹æ®µã€‚

* **IRQ8/16Priority**ï¼š**çº¯å®‰æ…°å‰‚**ã€‚åœ¨ Windows XP ä¹‹åçš„ ACPI/APIC ç¡¬ä»¶æ¶æ„ä¸‹ï¼Œæ‰‹åŠ¨æŒ‡å®š IRQ ä¼˜å…ˆçº§å·²è¢«ç³»ç»Ÿå†…æ ¸å¿½ç•¥ï¼Œæ— å®é™…ä½œç”¨ã€‚

---
    {AutoDetails}
            ]]>
			</Description>

			<Optimize>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl" Value="Win32PrioritySeparation" Type="REG_DWORD" Data="38"/>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl" Value="IRQ8Priority" Type="REG_DWORD" Data="1"/>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl" Value="IRQ16Priority" Type="REG_DWORD" Data="2"/>
			</Optimize>

			<Restore>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl" Value="Win32PrioritySeparation" Type="REG_DWORD" Data="2"/>
				<RegDelete Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl" Value="IRQ8Priority"/>
				<RegDelete Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\PriorityControl" Value="IRQ16Priority"/>
			</Restore>
		</Item>

		



		<Item name="å¢åŠ æ–‡ä»¶ç³»ç»Ÿ I/O ç¼“å­˜">
			<Tags>IoPageLockLimit,IO,ç¼“å­˜,é”å®šå†…å­˜</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
					Value="IoPageLockLimit"
					Data="10000000" />
			</StatusChecks>

			<Description>
				<![CDATA[
# ğŸ’¾ è°ƒæ•´ IoPageLockLimit  
å¢åŠ æ–‡ä»¶ç®¡ç†ç³»ç»Ÿç¼“å­˜  
è®¾ç½®ç³»ç»Ÿåœ¨è¿›è¡Œ I/O æ“ä½œæ—¶å¯é”å®šçš„æœ€å¤§å†…å­˜å­—èŠ‚æ•°ã€‚  

### è®¾ç½®å€¼
* **ç›®æ ‡å€¼**ï¼š`10000000` (åè¿›åˆ¶)

> **âš ï¸ æ€€æ—§é¡¹è­¦å‘Š (å®‰æ…°å‰‚)**ï¼š  
> è¿™æ˜¯ä¸€ä¸ª **XP/2000 æ—¶ä»£** çš„é—ç•™è®¾ç½®ã€‚ç°ä»£ Windows (10/11) çš„å†…å­˜ç®¡ç†å™¨å·²ç»éå¸¸æ™ºèƒ½ï¼Œæ‰‹åŠ¨è®¾ç½®å›ºå®šå€¼é€šå¸¸ä¸å¦‚ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†é«˜æ•ˆã€‚ä»…ä½œä¸ºæ€€æ—§ä¿ç•™ã€‚

---
{AutoDetails}
        ]]>
			</Description>

			<Optimize>
				<RegWrite
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
					Value="IoPageLockLimit"
					Type="REG_DWORD"
					Data="10000000"/>
			</Optimize>

			<Restore>
				<RegWrite
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
					Value="IoPageLockLimit"
					Type="REG_DWORD"
					Data="0"/>
			</Restore>
		</Item>

		<Item name="ç¦ç”¨å®¶åº­ç»„ (HomeGroup) æ®‹ç•™æœåŠ¡">
			<Tags>HomeGroup,Legacy,Network,Service,Provider</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\HomeGroupProvider"
					Value="Start"
					Data="4" />
			</StatusChecks>

			<Description>
				<![CDATA[
# ğŸ›ï¸ ç¦ç”¨å®¶åº­ç»„ (å†å²æ®‹ç•™)

**å®¶åº­ç»„ (HomeGroup)** æ˜¯ Windows 7 æ—¶ä»£çš„å±€åŸŸç½‘å…±äº«åŠŸèƒ½ï¼Œå¾®è½¯å·²åœ¨ Windows 10 (1803) ä¸­å°†å…¶ç§»é™¤ã€‚

### ä¸ºä»€ä¹ˆè¿˜è¦ä¼˜åŒ–å®ƒï¼Ÿ
è™½ç„¶åŠŸèƒ½å…¥å£æ²¡äº†ï¼Œä½†åœ¨éƒ¨åˆ†è€æ—§ç³»ç»Ÿæˆ–å‡çº§ä¸Šæ¥çš„ç³»ç»Ÿä¸­ï¼Œåº•å±‚çš„ `HomeGroupProvider` æœåŠ¡å°¸ä½“å¯èƒ½ä¾ç„¶å­˜åœ¨ã€‚
* **å¼ºè¿«ç—‡ç¦éŸ³**ï¼šå½»åº•ç¦ç”¨è¿™ä¸ªæ—©å·²æ­»å»çš„æœåŠ¡ï¼Œè®©æœåŠ¡åˆ—è¡¨æ›´å¹²å‡€ã€‚
* **å¿ƒç†èˆ’é€‚**ï¼šçœ‹ç€å…¨ç»¿çš„ä¼˜åŒ–åˆ—è¡¨ï¼Œå¿ƒæƒ…ä¼šå˜å¥½ã€‚

---
{AutoDetails}
            ]]>
			</Description>

			<Optimize>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\HomeGroupProvider" Value="Start" Type="REG_DWORD" Data="4"/>
			</Optimize>

			<Restore>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\HomeGroupProvider" Value="Start" Type="REG_DWORD" Data="3"/>
			</Restore>
		</Item>


		<Item name="éšè— Edgeâ€œæ“ä½œç³»ç»Ÿä¸å†å—æ”¯æŒâ€çš„è­¦å‘Šæ¡">
			<Tags>Edge,Warning,Legacy,OS,SuppressUnsupportedOSWarning</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge"
					Value="SuppressUnsupportedOSWarning"
					Data="1" />
			</StatusChecks>

			<Description>
				<![CDATA[
# ğŸ”• å±è”½æ—§ç³»ç»Ÿè­¦å‘Šæ¨ªå¹…

ç¦æ­¢ Edge åœ¨ Windows 7/8/8.1 ç­‰æ—§ç‰ˆæ“ä½œç³»ç»Ÿä¸Šæ˜¾ç¤ºâ€œä¸å†æ”¯æŒæ­¤ OSâ€çš„é¡¶éƒ¨æ¨ªå¹…ã€‚

### é€‚ç”¨åœºæ™¯
* **è™šæ‹Ÿæœº/è€æœºå‹**ï¼šå¦‚æœä½ åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œæ—§ç‰ˆ Windows ç”¨äºæµ‹è¯•ï¼Œå¼€å¯æ­¤é¡¹å¯ç§»é™¤æµè§ˆå™¨é¡¶éƒ¨çš„æ°¸ä¹…è­¦å‘Šæ¡ã€‚
* **ç°ä»£ç³»ç»Ÿ**ï¼šå¯¹äº Windows 10/11 ç”¨æˆ·ï¼Œæ­¤é€‰é¡¹**æ²¡æœ‰å¯è§æ•ˆæœ**ï¼Œä½†å¼€å¯å®ƒæ— å‰¯ä½œç”¨ã€‚

---
{AutoDetails}
            ]]>
			</Description>

			<Optimize>
				<RegWrite Key="HKEY_CURRENT_USER\Software\Policies\Microsoft\Edge" Value="SuppressUnsupportedOSWarning" Type="REG_DWORD" Data="1"/>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge" Value="SuppressUnsupportedOSWarning" Type="REG_DWORD" Data="1"/>
				<RegWrite Key="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge" Value="SuppressUnsupportedOSWarning" Type="REG_DWORD" Data="1" Wow64="True"/>
			</Optimize>

			<Restore>
				<RegDelete Key="HKEY_CURRENT_USER\Software\Policies\Microsoft\Edge" Value="SuppressUnsupportedOSWarning"/>
				<RegDelete Key="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge" Value="SuppressUnsupportedOSWarning"/>
				<RegDelete Key="HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Edge" Value="SuppressUnsupportedOSWarning" Wow64="True" SkipError="2"/>
			</Restore>
		</Item>

		<Item name="å¯ç”¨å¤§ç³»ç»Ÿç¼“å­˜">
			<Tags>LargeSystemCache,ç¼“å­˜,æ€§èƒ½,å†…å­˜ç®¡ç†</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
					Value="LargeSystemCache"
					Data="0" />
			</StatusChecks>

			<Description>
				<![CDATA[
# ğŸ§  å¯ç”¨ LargeSystemCache

å¯ç”¨"å¤§å‹ç³»ç»Ÿç¼“å­˜"
* å¾®è½¯å®˜æ–¹æ–‡æ¡£å·²ç»æ˜ç¡®æ³¨æ˜å·²å¼ƒç”¨, ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœ
* 0 ç¦ç”¨
* 1 å¯ç”¨

### æ ¸å¿ƒæœºåˆ¶
* 0 ç¦ç”¨ï¼Œé€‚ç”¨äºéœ€è¦æ›´å¤šå†…å­˜ä¾›å…¶ä»–åº”ç”¨ç¨‹åºä½¿ç”¨çš„æ¡Œé¢æˆ–ä¸ªäººç”µè„‘ã€‚
* 1 å¯ç”¨, é€‚ç”¨äºé«˜å†…å­˜çš„æœåŠ¡å™¨ï¼Œèƒ½æé«˜æ–‡ä»¶ç³»ç»Ÿçš„ç¼“å­˜æ•ˆç‡ï¼Œæå‡ç£ç›˜ I/O æ€§èƒ½ã€‚

> **âš ï¸ æ€€æ—§é¡¹è­¦å‘Š**ï¼š  
> å¯¹äºä¸ªäººç”µè„‘/æ¸¸æˆç”¨é€”ï¼Œè¿™é€šå¸¸æ˜¯**è´Ÿä¼˜åŒ–**ã€‚å› ä¸ºå®ƒä¼šæŠ¢å åº”ç”¨ç¨‹åºçš„ç‰©ç†å†…å­˜ï¼Œå¯¼è‡´æ¸¸æˆæˆ–è½¯ä»¶æ›´å®¹æ˜“è¢«æŒ¤åˆ°è™šæ‹Ÿå†…å­˜ä¸­ï¼Œä»è€Œå˜å¡ã€‚
* åœ¨ Win10/11 ä¸Šï¼Œç³»ç»Ÿè‡ªèº«çš„åŠ¨æ€ç®¡ç†å·²ç»éå¸¸ä¼˜ç§€ã€‚é™¤éä½ æŠŠç”µè„‘å½“ NAS ç”¨(é¢‘ç¹æ‹·è´å¤§æ–‡ä»¶)
* é’ˆå¯¹æ—©æœŸçš„WIN XP/Server 2003çš„é€‰é¡¹ï¼Œåœ¨WIN10/11ç‰ˆæœ¬è¿™ä¸€å±æ€§å·²ç»è¢«å¼ƒç”¨ã€‚
è¿™ä¸ªé€‰é¡¹å¼€ä¸å¼€ä¸ä¼šæœ‰å¯¹ä½ çš„ç”µè„‘ä¸ä¼šä»»ä½•å½±å“ã€‚
---
{AutoDetails}
        ]]>
			</Description>

			<Optimize>
				<RegWrite
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
					Value="LargeSystemCache"
					Type="REG_DWORD"
					Data="0"/>
			</Optimize>

			<Restore>
				<RegWrite
					Key="HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management"
					Value="LargeSystemCache"
					Type="REG_DWORD"
					Data="1"/>
			</Restore>
		</Item>

		<Item name="Disabled ASLR">
			<Tags>MitigationOptions,ASLR,ä¹±åºå†…å­˜,å®‰å…¨,æ¼æ´é˜²æŠ¤</Tags>

			<StatusChecks>
				<Check
					Key="HKEY_LOCAL_MACHINE\System\ControlSet001\Control\Session Manager\kernel"
					Value="MitigationOptions"
					Data="22,22,22,00,00,02,00,00,00,02,00,00,00,00,00,00" />
			</StatusChecks>

			<Description>
				<![CDATA[
# å…³é—­ä¹±åºå†…å­˜ / å…³é—­ Exploit Protection / ç¦ç”¨ ASLR

**è­¦å‘Šï¼šæåº¦å±é™©ï¼** æ­¤é€‰é¡¹å°†ä¿®æ”¹ `MitigationOptions` ä»¥å…³é—­ ASLRï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰ã€‚

### ä¸ºä»€ä¹ˆä¸åº”è¯¥ä½¿ç”¨ï¼Ÿ
* **å®‰å…¨é£é™©**ï¼šå†…å­˜åœ°å€å›ºå®šåŒ–ï¼Œç›¸å½“äºæŠŠâ€œå¤§é—¨é’¥åŒ™æŒ‚åœ¨é—¨æŠŠæ‰‹ä¸Šâ€ã€‚é»‘å®¢å¯ä»¥è½»æ¾é¢„æµ‹å…³é”®ç»„ä»¶åœ°å€è¿›è¡Œç¼“å†²åŒºæº¢å‡ºæ”»å‡»ã€‚
* **æ€§èƒ½è¿·æ€**ï¼šç°ä»£ CPU æ‹¥æœ‰ MMU ç¡¬ä»¶åŠ é€Ÿï¼Œå¼€å¯ ASLR çš„æ€§èƒ½æŸè€—å‡ ä¹ä¸º 0ã€‚

> **é€‚ç”¨åœºæ™¯**ï¼šä»…é™å®Œå…¨æ–­ç½‘ç¯å¢ƒä¸‹ï¼Œè¿è¡Œ 2000 å¹´ä»¥å‰ä¾èµ–å›ºå®šå†…å­˜åœ°å€çš„**å·¥ä¸šè€è½¯ä»¶**ã€‚

---
{AutoDetails}
        ]]>
			</Description>

			<Optimize>
				<RegWrite
					Key="HKEY_LOCAL_MACHINE\System\ControlSet001\Control\Session Manager\kernel"
					Value="MitigationOptions"
					Type="REG_BINARY"
					Data="22,22,22,00,00,02,00,00,00,02,00,00,00,00,00,00"/>
			</Optimize>

			<Restore>
				<RegDelete
					Key="HKEY_LOCAL_MACHINE\System\ControlSet001\Control\Session Manager\kernel"
					Value="MitigationOptions"/>
			</Restore>
		</Item>

		
	</Configuration>
</CyanSight>

